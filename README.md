# 🎥 ezlive - 교육용 P2P 화상 강의 플랫폼

WebRTC와 PeerJS를 활용한 브라우저 기반 1:1 화상 강의 애플리케이션입니다.

## 📋 프로젝트 개요

ezlive는 교사와 학생 간의 직접 연결을 통해 화상 통화와 채팅을 제공하는 교육용 웹 애플리케이션입니다. 서버 없이 P2P 방식으로 작동하여 간편하게 사용할 수 있습니다.

**개발:** (주)이지올댓, 연세대학교 인지공학 연구실

## ✨ 주요 기능

### 현재 구현된 기능

✅ **교육용 UI** ⭐ MAJOR UPDATE (v4.5.0)
- 교사용 화상강의 생성
- 학생용 강의참여
- **교사/학생 이름 입력** ⭐ NEW
- 교사 비밀번호 인증 (클라이언트 검증)
- **로그인 정보 파일 관리** ⭐ ENHANCED (v4.5.0)
  - **💾 입력저장 버튼**: 교사 정보를 txt 파일로 저장 (작은 버튼)
  - **📂 로그인정보 불러오기 버튼**: txt 파일에서 정보 불러오기 (작은 버튼)
  - 파일로 안전하게 정보 백업 및 공유
  - 다른 컴퓨터에서도 동일한 정보 사용 가능
  - 구형식("회의실 코드")/신형식("회의실 이름") 파일 모두 호환
- **강의 코드 시스템**
  - 사용자가 직접 입력 (빈칸 허용 안 함)
  - 같은 코드로 항상 접속 가능
  - 중복 코드 자동 감지 및 경고
  - **교사 Peer 지속성**: 학생 퇴장 시에도 교사의 Peer는 유지되어 같은 코드로 재접속 가능
- **초대링크 기능** ⭐ NEW
  - 원클릭 초대링크 생성
  - 강의 코드 입력 생략
  - 학생 이름만 입력하고 바로 참여
  - URL query parameter 기반 (invitation-code)

✅ **화상 통화 기능**
- 실시간 비디오 스트리밍
- 교사/학생 화면 표시
- 비디오 on/off 토글
- 마이크 on/off 토글
- 통화 종료 기능

✅ **PIP (Picture-in-Picture)** ⭐ NEW
- 상대방 화면 PIP 모드
- 내 화면 PIP 모드
- 다른 작업 중에도 영상 시청 가능
- 브라우저 네이티브 PIP 지원
- **비디오 최대화/최소화 토글** ⭐ NEW
  - 그리드 레이아웃 내에서 비디오 크기 조절
  - 한 화면을 2배로 확대하여 집중 시청

✅ **화면 공유 기능** ⭐ MAJOR UPDATE (v4.4.0)
- 전체 화면 공유 지원
- 특정 창/탭 선택 공유
- 실시간 화면 전환
- **시스템 오디오 캡처** ⭐ NEW (v4.4.0)
  - 화면공유 시 컴퓨터 소리 전송
  - 마이크 오디오와 독립적으로 작동
  - 동영상, 음악 재생 소리 공유 가능
  - 고품질 오디오 전송 (44.1kHz)
- 원클릭 카메라 복귀
- 전체화면 보기 모드
- **학생 화면공유 승인 시스템** ⭐ NEW
  - 학생이 화면공유 시 교사에게 자동 요청
  - 교사가 승인/거부 결정
  - 승인 후 화면공유 시작
- **화면공유 시작/종료 알림** ⭐ NEW
  - 채팅에 화면공유 시작/종료 시스템 메시지
  - 상대방에게도 알림 전송
- **판서 기능** ⭐ ENHANCED (v4.4.0)
  - **수동 실행**: 판서 버튼을 눌러야 활성화 (자동 실행 X)
  - **새창 모드**: 판서 도구를 별도 팝업 창으로 띄우기
  - **멀티 페이지**: 여러 페이지 추가 및 관리 ⭐ NEW (v4.4.0)
  - **전체 PDF 저장**: 모든 페이지를 하나의 PDF로 저장 ⭐ NEW (v4.4.0)
  - **포인터 기능**: 붉은 점 포인터로 강조 표시
  - **채팅 헤더 버튼**: 화면공유 시작 시 채팅 헤더에 판서 버튼 자동 표시
  - **완전한 토글**: 판서 도구를 끄면 모든 기능 완전히 중단
  - 화면공유 중 실시간 그리기
  - 색상 선택, 굵기 조절
  - 펜/지우개/포인터 모드 전환
  - 전체 삭제 기능
  - 전체화면/최대화에서도 항상 사용 가능

✅ **텍스트 채팅** ⭐ IMPROVED
- 실시간 메시지 전송
- 메시지 타임스탬프 표시
- 보낸 메시지/받은 메시지 구분
- 채팅 기록 CSV 다운로드
- **채팅 전체화면 모드** ⭐ NEW
- 채팅 새창 팝업 기능
- 입력란 상단 배치
- **파일 전송 기능** ⭐ NEW (최대 100MB)

✅ **전체화면 기능** ⭐ IMPROVED
- 비디오 전체화면 보기 (상대방/내 화면 각각)
- 전체화면 중 채팅 우측 고정 (400px)
- ESC 키로 나가기
- 채팅과 함께 동시 사용 가능

✅ **녹화 기능** ⭐ v4.3.0 업데이트
- **원클릭 녹화**: 브라우저에서 직접 녹화
- **학생 녹화 승인 시스템** ⭐ NEW
  - 학생 녹화 시 교사에게 자동 요청
  - 교사가 승인/거부 결정
  - 승인 후에만 녹화 가능
  - 채팅에 승인/거부 기록
- **화면 + 음성**: 화면과 마이크 오디오 동시 녹화
- **WebM 포맷**: 고화질 영상 (2.5Mbps)
- **자동 저장**: 다운로드 폴더에 자동 저장
- **실시간 표시**: 녹화 중 버튼 깜빡임 효과
- **채팅 알림**: 녹화 시작/중지 시스템 메시지

✅ **화면 캡쳐 기능** ⭐ NEW (v4.3.0)
- **📸 캡쳐 버튼**: 각 비디오 화면에 캡쳐 버튼 추가
- **PNG 저장**: 현재 화면을 PNG 이미지로 저장
- **양쪽 캡쳐**: 상대방 화면과 내 화면 모두 캡쳐 가능
- **원본 해상도**: 비디오 원본 해상도 유지
- **자동 파일명**: `ezlive_capture_타입_날짜_시간.png`
- **다운로드 폴더**: 녹화 파일과 같은 위치에 저장

✅ **UI/UX 개선** ⭐ MAJOR UPDATE
- **컨트롤 바를 헤더 아래로 이동**
- **모든 버튼에 텍스트 레이블 표시**
  - 비디오 🎥
  - 마이크 🎤
  - 화면공유 🖥️
  - **판서** ✏️ ⭐ NEW (화면공유 중에만 표시)
  - **채팅창 토글** 💬 ⭐ NEW
  - 채팅저장 💾
  - LMS 바로가기 🎓
  - **교재자료실** 📚 ⭐ NEW (v4.5.0)
  - **다시보기** 🔄 ⭐ NEW
  - **녹화** ⏺️ ⭐ NEW
  - **녹화폴더** 📁 ⭐ NEW
  - 종료 ❌
- **비디오 화면에 실제 이름 표시** ⭐ NEW
- **채팅에 이름 표시** ⭐ NEW
- 채팅 입력란 상단 배치
- 1:1 비율 비디오 그리드 레이아웃
- 파일전송 버튼 텍스트 표시

✅ **P2P 연결**
- PeerJS를 통한 WebRTC 연결
- STUN 서버를 통한 NAT 통과
- 자동 Peer ID 생성
- 연결 코드 복사 기능

✅ **종료 시 채팅 저장** ⭐ NEW
- 통화 종료 시 채팅 저장 확인 모달
- 저장하고 종료 / 종료만 / 취소 선택 가능
- CSV 형식으로 자동 다운로드

✅ **반응형 디자인** ⭐ MAJOR UPDATE
- 모바일/태블릿/데스크톱 완벽 최적화
- 모바일 전용 슬라이드업 채팅창
- 터치 친화적 UI
- **모바일 컨트롤 바**: 가로 스크롤 버튼
- **모바일 비디오 레이아웃**: 세로 스택
- **모바일 전체화면**: 채팅창 하단 고정
- **비디오 자동재생 처리**: 모바일 정책 대응

## 📱 모바일 사용 가이드

### 모바일 접속 방법

**카카오톡/네이버 등 인앱 브라우저 사용 시:**
- ⚠️ 자동으로 외부 브라우저(Chrome/Safari) 열기 안내 표시
- iOS: Safari로 열기 안내
- Android: 자동으로 Chrome 실행

**권장 브라우저:**
- 📱 iOS: Safari
- 📱 Android: Chrome

### 모바일 최적화 기능

**컨트롤 바:** ⭐ v4.3.0 그리드 레이아웃
- 🎯 **4열 그리드 레이아웃** ⭐ NEW
- 📱 모든 버튼 한눈에 표시
- 👆 스크롤 필요 없음
- 💪 터치하기 쉬운 큰 버튼
- 📐 균등한 버튼 크기
- 🎨 아이콘 + 텍스트 레이블

**비디오 화면:**
- 📺 세로 스택 레이아웃 (상대방 위, 나 아래)
- 16:9 비율 자동 조절
- 전체화면 시 100% 확대

**채팅창:**
- 👆 채팅 헤더 탭하여 열기/닫기
- 하단에서 슬라이드업 애니메이션
- 접힌 상태에서도 일부 보임 (60px)
- 전체화면 시 하단 40vh 고정

**판서 도구:**
- 화면공유 중 하단 우측에 표시
- 터치로 그리기 지원
- 색상/굵기 조절 가능

**화면공유 (모바일):** ⭐ NEW
- iOS Safari, Android Chrome 지원
- 모바일 기기 화면 공유 가능
- 앱 화면, 게임 화면 등 공유

**녹화 (모바일):** ⭐ NEW
- 모바일 기기에서 화면 녹화
- 시스템 오디오 캡처 시도
- WebM 형식으로 저장

**비디오 자동재생:**
- 일부 모바일 브라우저에서 자동재생 제한
- 재생 버튼이 나타나면 탭하여 시작

## 🚀 사용 방법

### 시작 화면 - 교사/학생 선택 ⭐ v4.5.0 변경

**첫 화면:**
1. **🏫 교사 시작** 또는 **🎓 학생 시작** 선택

**교사 선택 시:**
1. 교사 전용 비밀번호 입력 화면 표시
2. 비밀번호 입력: `a123456!`
3. 인증 성공 후 회의실 생성 화면으로 이동
4. ⚠️ 비밀번호가 틀리면 재입력 요청

**학생 선택 시:**
1. 즉시 회의실 참여 화면으로 이동
2. 별도 인증 없음

### 교사용 - 회의실 생성 ⭐ v4.5.0 변경

**빠른 시작 (저장된 정보 파일 사용):** ⭐ NEW
1. **📂 로그인정보 불러오기** 버튼 클릭
2. 이전에 저장한 txt 파일 선택
3. 교사 정보가 자동으로 입력됨
4. **회의실 생성** 버튼 클릭
5. 즉시 회의실 생성 완료!

**새로 시작:**
1. **교사 이름 입력**: 예) "김선생님"
2. **회의실 이름 입력**: 예) "class01", "math2024", "room123" 등
3. **회의실 비밀번호 입력**: 예) "1234"
4. **💾 입력저장 버튼 클릭** ⭐ 중요!
   - 입력한 정보가 txt 파일로 다운로드됨
   - 파일명: `ezlive_로그인정보_회의실코드.txt`
   - 이 파일을 안전하게 보관하세요!
5. **회의실 생성** 버튼 클릭
5. **학생 없이 먼저 입장 가능** ⭐ NEW
   - 회의실 생성 즉시 대기 모드 진입
   - 학생 접속 전까지 대기
   - 여러 학생 순차 접속 가능
6. 2가지 공유 방법 선택:
   - **회의실 코드 + 비밀번호**: 학생이 직접 입력
   - **초대 링크** ⭐ 추천: 클릭만으로 간편하게 참여
7. 학생 접속 시 비밀번호 자동 검증
8. 연결되면 자동으로 화상 회의 시작

💡 **TIP**: 기본값(class01 / 1234)을 그대로 사용하면 매번 같은 정보로 빠르게 입장할 수 있습니다!

⚠️ **비밀번호 보안**: 학생도 비밀번호를 입력해야 하며, 불일치 시 자동으로 차단됩니다.

### 학생용 - 회의실 참여 ⭐ v4.5.0 변경

**방법1: 초대링크 사용** ⭐ 추천
1. 교사가 공유한 **초대링크** 클릭
2. 자동으로 회의실 참여 페이지 열림 (교사/학생 선택 건너뜀)
3. **학생 이름 입력**: 예) "홍길동"
4. **회의실 비밀번호 입력**: 교사에게 받은 비밀번호
5. **회의실 참여** 버튼 클릭
6. 비밀번호 자동 검증
7. 카메라/마이크 권한 허용
8. 승인되면 자동으로 교사와 연결

**방법2: 회의실 코드 직접 입력**
1. ezlive 홈페이지 접속
2. **🎓 학생 시작** 버튼 클릭
3. **학생 이름 입력**: 예) "홍길동"
4. **회의실 코드 입력**: 교사에게 받은 코드
5. **회의실 비밀번호 입력**: 교사에게 받은 비밀번호
6. **회의실 참여** 버튼 클릭
7. 비밀번호 자동 검증
8. 카메라/마이크 권한 허용
9. 승인되면 자동으로 교사와 연결

⚠️ **비밀번호 필수**: 비밀번호가 일치하지 않으면 자동으로 차단되며 페이지가 새로고침됩니다.

💡 **학생 재접속 가능**: 학생이 나갔다가 다시 들어와도 같은 회의실 코드와 비밀번호로 재접속 가능합니다. 교사는 계속 대기 중입니다.

### 화상 강의 중

**헤더 아래 컨트롤 바:**
- **📹 비디오**: 카메라 on/off
- **🎤 마이크**: 마이크 on/off
- **🖥️ 화면공유**: 화면/창 공유 시작/중지 ⭐ ENHANCED (v4.4.0)
  - 교사: 즉시 화면공유 시작
  - 학생: 교사에게 승인 요청 → 승인 후 시작
  - 모바일: 기기 화면 공유 가능
  - **시스템 오디오 전송**: 컴퓨터 소리도 함께 공유 ⭐ NEW
- **✏️ 판서도구**: 화이트보드 열기/닫기 (독립 기능) ⭐ ENHANCED (v4.4.0)
  - 새창으로 화이트보드 표시
  - 실시간으로 상대방에게 공유
  - 화면공유 없이도 사용 가능
  - **멀티 페이지 지원**: 여러 페이지 작성 및 이동 ⭐ NEW
  - **전체 PDF 저장**: 모든 페이지를 하나의 PDF로 저장 ⭐ NEW
- **✏️ 판서 (화면공유 중)**: 화면 위에 직접 그리기 ⭐ v4.1.0 개선
  - **채팅 헤더 버튼**: 화면공유 시작 시 채팅 헤더에 판서 버튼(✏️) 자동 표시
  - **즉시 접근**: 채팅창 상단에서 바로 판서 도구 실행
  - **완전한 토글**: 판서 도구를 끄면 그리기 기능도 완전히 중단
  - **상태 동기화**: 컨트롤 바와 채팅 헤더 버튼의 활성 상태 동기화
  - 판서만 끄고 화면공유 유지 가능
- **💬 채팅창**: 채팅창 열기/닫기
- **💾 채팅저장**: 채팅 기록 CSV 다운로드
- **🎓 LMS**: LMS 사이트 바로가기 (https://www.ezlive.kr/)
- **📚 교재자료실**: 교재자료실 바로가기 ⭐ NEW (v4.5.0)
  - https://ezlive.kr/Source/Book/index.php
  - 교재 및 학습 자료 다운로드
- **🔄 다시보기**: 다시보기 사이트 (https://jlive.co.kr/)
- **❌ 종료**: 통화 종료

**비디오 화면:** ⭐ v4.3.0 업데이트
- **1:1 비율**: 상대방 화면과 내 화면이 동일한 크기로 표시
- **실제 이름 표시**: 교사명/학생명이 화면에 표시됨
- **📸 캡쳐** ⭐ NEW: 현재 화면을 PNG 이미지로 저장
- **🖼️ PIP**: Picture-in-Picture 모드 (각 화면마다)
- **⤢ 최대화**: 그리드 내에서 비디오 2배 확대
- **⛶️ 전체화면**: 화면 전체를 사용하여 보기 (각 화면마다)

**채팅 기능:**
- **입력란**: 채팅 화면 상단에 배치
- **이름 표시**: 각 메시지에 보낸 사람 이름 표시
- **파일전송**: 이미지, 문서 등 파일 공유 (최대 100MB)
- **⛶️ 전체화면**: 채팅을 전체화면으로 확대
- **🗗️ 새창**: 채팅을 별도 창으로 팝업
- **토글**: 채팅창을 닫았다 다시 열 수 있음

## 🎮 주요 기능 사용법

### PIP (Picture-in-Picture) 모드

1. 상대방 화면 또는 내 화면의 **🖼️** 버튼 클릭
2. 브라우저가 PIP 창 생성
3. 다른 작업하면서 영상 계속 시청
4. PIP 창 닫거나 버튼 다시 클릭하면 종료

**활용:**
- 다른 자료 보면서 강의 시청
- 문서 작업하면서 화상 회의
- 멀티태스킹 환경에서 효율적

### 화면공유 시스템 오디오 ⭐ NEW (v4.4.0)

화면공유 시 컴퓨터에서 재생되는 소리를 함께 전송할 수 있습니다:

**시스템 오디오 공유:**
1. **🖥️ 화면공유** 버튼 클릭
2. 화면 선택 창에서 **시스템 오디오 공유** 옵션 확인
3. "오디오 공유" 또는 "시스템 오디오" 체크박스 선택
4. 공유할 화면/창/탭 선택
5. 화면과 소리가 함께 전송됨

**전송 가능한 소리:**
- YouTube, Netflix 등 동영상 소리
- 음악 재생 소리
- 게임 소리
- 프레젠테이션 동영상 소리
- 모든 컴퓨터 오디오

**브라우저별 지원:**
- ✅ Chrome/Edge: 완벽 지원 (권장)
- ✅ Firefox: 지원
- ⚠️ Safari: 제한적 (macOS Monterey 이상)

**주의사항:**
- 시스템 오디오 공유는 브라우저가 결정
- 일부 브라우저는 탭 오디오만 지원
- 화면공유 종료 시 마이크로 자동 복귀
- 시스템 오디오가 없으면 마이크만 전송

**활용:**
- 동영상 강의 소리 공유
- 음악 수업에서 실시간 재생
- 게임 플레이 시연
- 프레젠테이션 비디오 재생

### 채팅 전체화면 모드

1. 채팅 헤더의 **⛶️** 버튼 클릭
2. 채팅이 전체 화면으로 확대
3. 대화 내용을 크게 보기
4. **⊎** 버튼이나 **ESC** 키로 복귀

**활용:**
- 긴 대화 내용 한눈에 보기
- 채팅 기록 검토
- 화면 녹화 시 채팅만 크게

### 비디오 전체화면 + 채팅

1. 비디오 화면의 **⛶️** 버튼으로 전체화면
2. 우측 하단에 **💬** 버튼 자동 표시
3. 💬 버튼 클릭하면 채팅 전체화면 열림
4. 전체화면 상태에서 채팅 가능

**활용:**
- 프레젠테이션 전체화면 중 Q&A
- 강의 화면 집중하면서 채팅 확인

## 📁 파일 구조

```
ezlive/
├── index.html          # 메인 HTML 파일
├── css/
│   └── style.css       # 스타일시트 (반응형 디자인 포함)
├── js/
│   └── app.js          # 애플리케이션 로직
└── README.md           # 프로젝트 문서
```

## 🛠 기술 스택

- **HTML5**: 시맨틱 마크업, video 태그 (playsinline 속성)
- **CSS3**: 반응형 디자인 (@media queries), 그라디언트, 애니메이션
- **JavaScript (ES6+)**: 클래스 기반 구조
- **PeerJS 1.5.2**: WebRTC 래퍼 라이브러리
- **WebRTC**: 실시간 통신 (비디오, 오디오, 데이터)
- **getDisplayMedia API**: 화면 공유 및 시스템 오디오 캡처 ⭐ ENHANCED (v4.4.0)
- **Picture-in-Picture API**: PIP 기능
- **MediaRecorder API**: 화면 녹화 기능
- **Canvas API**: 판서 기능, 멀티 페이지 관리 ⭐ ENHANCED (v4.4.0)
- **jsPDF 2.5.1**: PDF 생성 (동적 로드, 다중 페이지 지원) ⭐ ENHANCED (v4.4.0)

## 📱 브라우저 요구사항

### 데스크톱 권장 브라우저
- ✅ **Chrome/Edge 74+** (최고의 호환성)
- ✅ **Firefox 66+**
- ✅ **Safari 12+**

### 모바일 권장 브라우저
- ✅ **iOS Safari 12+** (필수)
- ✅ **Android Chrome 74+** (필수)
- ⚠️ Samsung Internet (제한적)

### PIP 지원
- Chrome/Edge 70+
- Safari 13.1+
- Firefox 97+ (실험적)
- ❌ 모바일: PIP 제한적 (브라우저별 상이)

### 필수 권한
- 📷 카메라 접근 권한
- 🎤 마이크 접근 권한
- 🔊 자동재생 권한 (모바일)

### ⚠️ 지원하지 않는 브라우저
- ❌ **카카오톡 인앱 브라우저**
- ❌ **네이버 앱 브라우저**
- ❌ **페이스북 인앱 브라우저**
- ❌ **인스타그램 인앱 브라우저**
- ❌ **라인 인앱 브라우저**
- ❌ 기타 인앱 브라우저

**→ 위 브라우저에서 접속 시 자동으로 외부 브라우저 열기 안내**
- iOS: Safari 열기 가이드 표시
- Android: Chrome 자동 실행 (intent:// scheme)

## ⚠️ 제한사항 및 주의사항

### 기술적 제한
- **1:1 전용**: 현재는 교사-학생 1:1 연결만 지원 (다중 연결 불가)
- **P2P 연결**: 서버를 거치지 않으므로 일부 방화벽 환경에서 연결 어려움
- **네트워크 환경**: Symmetric NAT 환경에서는 TURN 서버 필요
- **화면 공유**: 모바일 브라우저에서는 제한적 (iOS Safari는 미지원)
- **녹화 기능**: 모바일에서 화면 녹화 제한적
- **비디오 자동재생**: 모바일 브라우저 정책에 따라 사용자 터치 필요

### 보안 주의사항
- **교사 인증 비밀번호**: `a123456!` (클라이언트 측 검증)
- **회의실 비밀번호**: 클라이언트 측 검증으로 진짜 보안 아님
- **소스코드 노출**: JavaScript에 하드코딩되어 개발자 도구로 확인 가능
- **우회 가능**: 기술적으로 숙련된 사용자는 우회 가능
- **교육/데모용**: 실제 보안이 필요한 환경에서는 서버 기반 시스템 권장
- **교사 비밀번호 변경 권장**: 실제 사용 시 소스코드에서 비밀번호 변경 필요

### 권장사항
진짜 보안과 다중 사용자가 필요하다면:
- Node.js + Express 서버
- 데이터베이스 (사용자 인증)
- WebRTC 시그널링 서버
- TURN 서버 (방화벽 통과)

## 🔒 보안 및 프라이버시

- **P2P 연결**: 모든 통신은 브라우저 간 직접 연결
- **암호화**: WebRTC 내장 암호화 (DTLS/SRTP)
- **서버 미경유**: 비디오/오디오 데이터는 서버를 거치지 않음
- **세션 관리**: 페이지 새로고침 시 연결 초기화
- **클라이언트 검증**: 교사 비밀번호는 간단한 확인용

## 💡 활용 사례

### 1. 1:1 과외/튜터링
- 교사가 강의 생성 후 학생 1명과 연결
- 화면 공유로 자료 설명
- 채팅으로 보충 설명
- PIP로 학생 반응 확인하며 작업

### 2. 원격 상담
- 상담사가 강의 생성
- 내담자가 코드로 참여
- 전체화면으로 집중 상담
- 채팅 기록 CSV 저장

### 3. 멘토링 세션
- 멘토가 화면 공유로 시연
- 멘티는 PIP로 화면 보며 실습
- 채팅으로 질문과 답변
- 세션 기록 CSV 저장

### 4. 온라인 발표 연습
- 발표자가 슬라이드 공유
- 피드백 제공자가 채팅으로 코멘트
- 전체화면으로 발표 연습
- 피드백 내역 CSV 저장

## 📊 데이터 모델

### PeerJS Connection
```javascript
{
    peer: string,          // 원격 peer ID
    open: boolean,         // 연결 상태
    metadata: object       // 연결 메타데이터
}
```

### Chat Message
```javascript
{
    type: string,          // 'sent' 또는 'received'
    message: string,       // 메시지 내용
    timestamp: string,     // 전송 시간 (HH:MM)
    fullTimestamp: string  // ISO 8601 형식 전체 시간
}
```

### CSV Export Format
```csv
시간,보낸사람,메시지
"14:30","나","안녕하세요"
"14:31","상대방","반갑습니다"
```

## 💡 모바일 사용 팁

### 📱 성능 최적화
- 안정적인 Wi-Fi 연결 권장
- 모바일 데이터 사용 시 데이터 소모 주의
- 배터리 충분한지 확인 (영상통화는 배터리 소모가 큼)

### 🎥 화질 및 연결
- 조명이 밝은 곳에서 사용
- 카메라 렌즈 청소
- 연결 불안정 시 Wi-Fi 재연결

### 🔊 오디오
- 이어폰/헤드셋 사용 권장 (에코 방지)
- 조용한 환경에서 사용
- 마이크 권한 허용 필수

### 👆 터치 조작
- 컨트롤 바: 좌우 스와이프
- 채팅창: 헤더 탭하여 열기/닫기
- 판서: 터치로 그리기
- 전체화면: 탭하여 토글

### 🔄 문제 해결
- 화면이 검게 나오면: 권한 확인
- 비디오가 재생 안 되면: 화면 탭하여 수동 재생
- 채팅이 안 보이면: 채팅 헤더 탭
- 연결이 끊기면: 새로고침 후 재접속
- **학생 재접속 시**: 교사는 그대로 대기 중이므로 같은 코드로 다시 접속 가능
- **판서 도구 반응 없음**: 화면공유 시작 후 채팅 헤더의 ✏️ 버튼 사용

## 🎯 향후 개발 계획

### 화면공유 승인 시스템 (학생용)

학생이 화면을 공유하려면 교사의 승인이 필요합니다:

**학생 절차:**
1. **🖥️ 화면공유** 버튼 클릭
2. 교사에게 자동으로 승인 요청 전송
3. 교사의 승인 대기
4. 승인되면 화면 선택 창 표시
5. 공유할 화면/창/탭 선택
6. 화면공유 시작

**교사 절차:**
1. 학생의 화면공유 요청 모달 표시
2. 학생 이름과 요청 내용 확인
3. **✅ 승인** 또는 **❌ 거부** 선택
4. 승인 시 학생의 화면이 공유됨
5. 거부 시 학생에게 알림 전송

**주의사항:**
- 교사는 승인 없이 즐시 화면공유 가능
- 학생은 반드시 교사의 승인 필요
- 채팅창에 승인/거부 내역 표시

### 화이트보드 기능 사용법 ⭐ ENHANCED (v4.4.0)

화이트보드는 독립적인 판서 공간으로 화면공유 없이도 사용할 수 있습니다:

**화이트보드 시작:**
1. 컨트롤 바에서 **✏️ 판서도구** 버튼 클릭
2. 1200x800 크기의 화이트보드 새창 열림
3. 자동으로 화이트보드가 상대방에게 공유됨
4. 실시간으로 그리기 가능

**화이트보드 도구:**
- **🖊️ 펜**: 자유롭게 그리기 (기본 검은색)
- **🧹 지우개**: 그린 내용 지우기 (배경은 유지)
- **🔴 포인터**: 화살표로 특정 위치 가리키기
- **색상**: 컬러 픽커로 펜 색상 변경
- **굵기**: 슬라이더로 선 굵기 조절 (1~20px)
- **🗑️ 전체삭제**: 현재 페이지 전체 지우기

**멀티 페이지 기능** ⭐ NEW (v4.4.0)
- **◀️ 이전 페이지**: 이전 페이지로 이동
- **▶️ 다음 페이지**: 다음 페이지로 이동
- **➕ 페이지 추가**: 새 빈 페이지 추가
- **페이지 정보**: 현재 페이지 / 전체 페이지 수 표시
- 각 페이지는 독립적으로 관리
- 페이지 전환 시 자동 저장

**저장 기능** ⭐ ENHANCED (v4.4.0)
- **💾 현재페이지 PNG**: 현재 페이지만 PNG로 저장
- **📄 모두 저장 (PDF)**: 모든 페이지를 하나의 PDF로 저장
  - 다중 페이지 PDF 생성
  - 페이지 순서대로 저장
  - 파일명에 총 페이지 수 표시

**화이트보드 종료:**
- 화이트보드 창 닫기 또는
- **✏️ 판서도구** 버튼 다시 클릭
- 종료 후 자동으로 카메라로 복귀 ⭐ v4.2.0 개선

**활용:**
- 수학 문제 풀이 (깨끗한 배경에서)
- 다이어그램 그리기
- 브레인스토밍
- 개념 설명
- 화면공유 없이 간단한 설명
- **여러 페이지 강의 자료 작성** ⭐ NEW
- **단계별 설명 (페이지별 진행)** ⭐ NEW

**장점:**
- 화면공유 필요 없음
- 깨끗한 흰색 배경
- 큰 작업 공간 (1200x800)
- 실시간 공유
- 터치 지원
- **멀티 페이지 지원** ⭐ NEW (v4.4.0)
- **전체 페이지 PDF 저장** ⭐ NEW (v4.4.0)
- PNG/PDF 저장 기능 ⭐ v4.2.0
- 카메라 자동 복원 ⭐ v4.2.0

**주의사항:**
- 화면공유 중에는 화이트보드 대신 화면공유 판서 도구 사용
- 화이트보드와 화면공유 판서는 별도 기능
- 페이지 전환 시 자동으로 현재 페이지가 저장됨

### 화면공유 중 판서 기능 ⭐ ENHANCED (v4.1.0)

화면공유 중에 공유 화면 위에 직접 그릴 수 있습니다:

**판서 시작:**
1. **화면공유** 시작 (교사 또는 학생)
2. **채팅 헤더에 ✏️ 판서 버튼이 자동 표시됨** ⭐ NEW
   - 채팅창 상단 우측에 판서 버튼 추가
   - 화면공유 중일 때만 표시
   - 컨트롤 바 또는 채팅 헤더 버튼 모두 사용 가능
3. **✏️ 판서** 버튼 클릭 (컨트롤 바 또는 채팅 헤더)
4. 별도 팝업 창에 판서 도구가 열림
5. 공유 중인 화면 위에 투명 캔버스 생성됨
6. 버튼이 활성 상태로 변경됨 (컨트롤 바와 채팅 헤더 모두)

**도구 사용 (새창):**
- **색상**: 원하는 색상 선택
- **굵기**: 슬라이더로 1~20px 조절
- **🖊️ 펜**: 그리기 모드 (기본)
- **🧹 지우개**: 판서만 지우기 (화면은 보존) ⭐ 버그 수정
- **🔴 포인터**: 붉은 점 포인터로 강조 표시
- **🗑️ 전체삭제**: 판서만 전체 삭제

**지우개 개선:**
- ✅ destination-out 모드 사용
- ✅ 판서만 지우고 배경 화면은 유지
- ✅ 투명 효과로 자연스러운 지우기
- ❌ 더 이상 화면이 흰색으로 지워지지 않음

**판서 종료:**
- **✏️ 판서** 버튼 다시 클릭 (컨트롤 바 또는 채팅 헤더)
- 판서 도구 창 자동 닫힘
- 캔버스와 그리기 기능 완전히 중단
- 버튼 활성 상태 해제 (컨트롤 바와 채팅 헤더 모두)
- 판서만 끄고 화면공유는 계속 가능

**독립적 제어:**
- 화면공유와 판서를 별도로 제어
- 판서만 끄고 화면공유 유지
- 화면공유만 끄고 판서 유지 (자동 정리)

**활용:**
- PPT 발표 중 강조
- 문서 설명 중 표시
- 웹사이트 설명 중 하이라이트
- 동영상 시청 중 주석
- 코드 리뷰 중 표시

### 녹화 기능 사용법

브라우저에서 직접 화면을 녹화합니다:

**녹화 시작:**
1. **⏺️ 녹화** 버튼 클릭
2. 녹화할 화면 선택 (전체 화면, 창, 탭)
3. 마이크 권한 허용 (음성 녹화)
4. 자동으로 녹화 시작
5. 버튼이 **⏹️ 중지**로 변경되고 빨간색으로 깜빡임

**녹화 중지:**
1. **⏹️ 중지** 버튼 클릭
2. 자동으로 파일 다운로드 시작
3. 파일명: `ezlive_recording_YYYYMMDD_HHMM.webm`

**녹화 파일 찾기:** ⭐ v4.2.0 개선
1. **📁 녹화폴더** 버튼 클릭
2. Chrome: 다운로드 폴더 자동 열기 시도
3. 다른 브라우저: 상세한 위치 안내
   - **Windows**: 
     - 경로: `C:\Users\사용자명\Downloads\`
     - 단축키: `Win + E` → 다운로드
     - 주소창: `shell:downloads`
   - **Mac**: 
     - 경로: `~/Downloads/`
     - 단축키: `Cmd + Option + L`
     - Finder → 다운로드

**녹화 기능:**
- 화면 + 음성 동시 녹화
- WebM 형식으로 저장
- 고화질 녹화 (2.5Mbps)
- 자동 파일명 생성 (날짜_시간)
- 채팅에 녹화 시작/중지 알림

**주의사항:**
- 화면 공유 권한 필요
- 마이크 권한 필요 (음성 녹화 시)
- WebM 형식 (Chrome, Edge, Firefox 지원)
- 긴 시간 녹화 시 파일 크기 주의
- 녹화 중 화면 공유 창을 닫으면 자동 중지

### 초대링크 사용법 ⭐ 추천

초대링크를 사용하면 학생들이 훨씬 쉽게 참여할 수 있습니다!

**교사 측 (링크 생성):**
1. 강의 생성 완료
2. Step 2 화면에서 2가지 공유 방법 확인:
   - 📋 **강의 코드**: 수동 입력 방식
   - 🔗 **초대 링크**: 원클릭 참여 방식 ⭐
3. **🔗 링크 복사** 버튼 클릭
4. 학생들에게 링크 전달 (카카오톡, 이메일, 문자 등)

**학생 측 (링크 사용):**
1. 교사가 보낸 초대링크 클릭
   ```
   예시: https://your-site.com/?invitation-code=abc123xyz
   ```
2. 자동으로 강의 참여 페이지 열림
3. 강의 코드 자동 입력됨 ✅
4. **학생 이름만 입력**
5. **강의 참여** 버튼 클릭
6. 즉시 연결! 🎉

**초대링크의 장점:**
- ✅ 강의 코드 복사/붙여넣기 불필요
- ✅ 입력 실수 방지
- ✅ 학생이 이름만 입력하면 끝
- ✅ 모바일에서도 편리
- ✅ 링크 하나로 모든 정보 전달

**초대링크 형식:**
```
https://[도메인]/?invitation-code=[강의코드]
```

**공유 방법:**
- 카카오톡: 링크 복사 → 전송
- 이메일: 링크 붙여넣기
- 문자메시지: 링크 전송
- 학습관리시스템(LMS): 공지사항에 링크 게시

**⚠️ 카카오톡/인앱 브라우저 사용 시:**
- 카카오톡, 네이버, 페이스북 등의 인앱 브라우저에서는 카메라/마이크 접근이 제한될 수 있습니다
- 링크 클릭 시 **자동으로 외부 브라우저 안내 페이지** 표시
- iOS: "Safari에서 열기" 안내
- Android: "Chrome에서 열기" 안내 또는 자동 리다이렉트
- 학생들에게 외부 브라우저에서 열도록 안내해주세요

### 종료 시 채팅 저장

통화 종료 시 채팅 기록 저장 여부를 선택할 수 있습니다:

1. **❌ 종료** 버튼 클릭
2. 모달 창 표시:
   - **💾 저장하고 종료**: 채팅 기록을 CSV로 다운로드 후 종료
   - **종료만**: 저장하지 않고 바로 종료
   - **취소**: 종료 취소하고 통화 계속

**CSV 파일 형식:**
```csv
시간,보낸사람,메시지
"14:30","김선생님","안녕하세요"
"14:31","홍길동","반갑습니다"
"14:32","시스템","화면공유를 시작했습니다."
```

### 파일 전송 사용법

1. 채팅 입력란 왼쪽의 **파일전송** 버튼 클릭
2. 전송할 파일 선택 (최대 100MB)
3. 자동으로 파일 전송
4. 상대방은 다운로드 버튼으로 파일 저장

**지원 파일:**
- 이미지: JPG, PNG, GIF 등
- 문서: PDF, Word, Excel, PowerPoint
- 압축: ZIP, RAR
- 동영상: MP4, AVI (용량 제한 내)
- 기타: 모든 파일 형식

**제한사항:**
- 최대 파일 크기: 100MB
- P2P 전송으로 서버 미경유
- 연결 종료 시 파일 이력 삭제
- 대용량 파일은 전송 시간이 소요될 수 있음

## 🎯 향후 개발 계획

### 미구현 기능

- [ ] **다중 사용자**: 3명 이상 동시 연결 (서버 필요)
- [ ] **진짜 인증 시스템**: 데이터베이스 기반 사용자 관리
- [ ] **강의실 룸**: 여러 강의실 동시 운영
- [ ] **대용량 파일 전송**: 100MB 이상 파일 (청크 전송)
- [ ] **화질 설정**: 비디오 해상도/프레임레이트 조절
- [ ] **네트워크 상태 표시**: 연결 품질 실시간 모니터링
- [ ] **손들기 기능**: 학생 질문 신호
- [ ] **출석 체크**: 참여 시간 기록
- [ ] **배경 효과**: 가상 배경, 블러
- [x] ~~**화이트보드**: 실시간 협업 그리기~~ ✅ 구현 완료 (v4.0.0)
- [x] ~~**멀티 페이지 화이트보드**~~ ✅ 구현 완료 (v4.4.0)
- [x] ~~**시스템 오디오 캡처**~~ ✅ 구현 완료 (v4.4.0)

### 추천 다음 단계

1. **TURN 서버 추가**: 방화벽 환경 지원
2. **서버 기반 시스템**: 진짜 인증과 다중 사용자
3. **마이크 + 시스템 오디오 믹싱**: AudioContext를 사용한 오디오 믹싱
4. **네트워크 품질 모니터링**: 실시간 연결 상태 표시
5. **손들기 기능**: 학생 질문 신호
6. **출석 체크**: 참여 시간 자동 기록

## 🚀 배포

웹사이트를 온라인으로 배포하려면 **Publish 탭**으로 이동하여 원클릭 배포하세요!

## 💻 개발 참고사항

### 로컬 테스트
- HTTPS 또는 localhost 환경 필요 (WebRTC/PIP 보안 요구사항)
- 두 개의 브라우저 탭 또는 다른 기기에서 테스트

### 디버깅
- 브라우저 개발자 도구 콘솔에서 연결 상태 확인
- PeerJS 이벤트 로그 확인

## 📄 라이선스

이 프로젝트는 교육 및 개인 사용 목적으로 제작되었습니다.

## 🙏 크레딧

- **PeerJS**: WebRTC 래퍼 라이브러리
- **Google STUN Servers**: NAT 통과 지원
- **WebRTC**: 실시간 통신 기술
- **Picture-in-Picture API**: 브라우저 PIP 기능
- **jsPDF**: PDF 생성 라이브러리 (판서도구 저장)

---

**최종 업데이트**: 2025-11-10  
**버전**: 4.5.0  
**개발:** (주)이지올댓, 연세대학교 인지공학 연구실  
**용도**: 교육용 1:1 화상 회의 플랫폼

---

## 🎉 버전 4.5.0 변경사항 ⭐ UX ENHANCEMENT

### 교사/학생 구분 시작 화면 ⭐ NEW
- ✅ **사용자 선택 단계 추가**
  - 첫 화면에서 교사/학생 선택
  - 명확한 역할 구분
  - 직관적인 UI

- ✅ **🏫 교사 시작**
  - 교사 전용 비밀번호 인증
  - 비밀번호: `a123456!`
  - 인증 성공 후 회의실 생성 화면
  - 보안 강화

- ✅ **🎓 학생 시작**
  - 별도 인증 없이 즉시 참여 화면
  - 빠른 접근
  - 간편한 사용

- ✅ **초대링크 자동 처리**
  - 초대링크로 접속 시 선택 단계 건너뜀
  - 바로 학생 참여 화면으로 이동
  - 최적화된 워크플로우

### 로그인 정보 파일 관리 시스템 ⭐ NEW
- ✅ **💾 입력저장 버튼** (작은 버튼으로 개선)
  - 교사 이름, 회의실 이름, 비밀번호를 txt 파일로 저장
  - 파일명: `ezlive_로그인정보_회의실이름.txt`
  - 안전한 정보 백업
  - 다른 컴퓨터에서도 사용 가능

- ✅ **📂 로그인정보 불러오기 버튼** (작은 버튼으로 개선)
  - 저장된 txt 파일 업로드
  - 파일에서 자동으로 정보 파싱
  - 구형식("회의실 코드")/신형식("회의실 이름") 모두 지원
  - 입력란에 자동 입력
  - 빠른 회의실 생성

- ✅ **파일 형식**
  ```
  ezlive 로그인 정보
  ==================
  교사 이름: 김선생님
  회의실 이름: class01
  회의실 비밀번호: 1234
  ==================
  저장일시: 2025-11-10 14:30:00
  ```

- ✅ **사용 시나리오**
  - 개인 백업: 정보를 파일로 보관
  - 다중 기기: 같은 정보를 여러 컴퓨터에서 사용
  - 정보 공유: 관리자가 교사에게 정보 파일 전달
  - 보안 관리: 파일을 암호화하여 안전하게 보관 가능

### 교재자료실 바로가기 ⭐ NEW
- ✅ **📚 교재자료실 버튼**
  - 컨트롤 바에 교재자료실 버튼 추가
  - https://ezlive.kr/Source/Book/index.php 링크 연결
  - 화상 통화 중 교재 다운로드 가능
  - 새 탭으로 열림

- ✅ **편리한 접근**
  - LMS 버튼 옆에 배치
  - 수업 중 교재 바로 확인
  - 학생과 함께 자료 공유

### 브랜딩 및 저작권 정보 업데이트
- ✅ **시작 화면 개선**
  - 타이틀: "ezlive"
  - 저작권: "Copyright (주)이지올댓, 연세대학교 인지공학 연구실"
  - 설명: "화상 솔루션"
  - 전문적인 디자인

## 🎉 버전 4.4.0 변경사항 ⭐ MAJOR UPDATE

### 화이트보드 멀티 페이지 지원 ⭐ NEW
- ✅ **페이지 추가 기능**
  - ➕ 페이지 추가 버튼으로 새 페이지 생성
  - 무제한 페이지 추가 가능
  - 각 페이지는 독립적으로 관리
  - 빈 페이지로 시작

- ✅ **페이지 네비게이션**
  - ◀️ 이전 페이지 버튼
  - ▶️ 다음 페이지 버튼
  - 현재 페이지 / 전체 페이지 표시
  - 페이지 전환 시 자동 저장

- ✅ **전체 페이지 PDF 저장**
  - 📄 모두 저장 (PDF) 버튼
  - 모든 페이지를 하나의 PDF로 저장
  - 페이지 순서대로 저장
  - 파일명에 총 페이지 수 표시
  - 예: `ezlive_whiteboard_5pages_2025-11-10.pdf`

- ✅ **개별 페이지 PNG 저장**
  - 💾 현재페이지 PNG 버튼
  - 현재 보고 있는 페이지만 저장
  - 파일명에 페이지 번호 표시
  - 예: `ezlive_whiteboard_page3_2025-11-10.png`

### 화면공유 시스템 오디오 캡처 ⭐ ENHANCED
- ✅ **시스템 오디오 전송**
  - 화면공유 시 컴퓨터 소리 캡처
  - 동영상 재생 소리 공유
  - 음악, 게임 소리 전송
  - 마이크와 독립적으로 작동

- ✅ **고품질 오디오**
  - 샘플레이트: 44.1kHz
  - 에코 캔슬레이션 비활성화
  - 노이즈 억제 비활성화
  - 로컬 오디오 재생 억제 비활성화

- ✅ **자동 오디오 선택**
  - 시스템 오디오 우선 전송
  - 시스템 오디오 없으면 마이크 유지
  - 화면공유 종료 시 마이크로 자동 복귀
  - 콘솔 로그로 오디오 소스 확인

### 카메라 전환 버튼 개선 ⭐ ENHANCED
- ✅ **2개 카메라 토글 모드**
  - 카메라가 2개인 경우 완벽한 토글
  - 첫 번째 ↔ 두 번째 카메라 전환
  - 다시 누르면 이전 카메라로 복귀
  - 직관적인 앞/뒤 카메라 전환

- ✅ **3개 이상 카메라 순환 모드**
  - 카메라가 3개 이상이면 순환 방식
  - 1 → 2 → 3 → 1 순서로 전환
  - 모든 카메라 접근 가능

## 🎉 버전 4.3.0 변경사항 ⭐ MAJOR UPDATE

### 회의실 코드 시스템으로 전환
- ✅ **강의코드 → 회의실코드 변경**
  - 명칭을 "회의실 코드"로 통일
  - 기본값: `class01` (자동 입력)
  - 언제든 변경 가능
  - 일관된 사용 경험

- ✅ **비밀번호 시스템 개선**
  - 기본 비밀번호: `1234`
  - 교사/학생 모두 비밀번호 입력 필수
  - 학생 접속 시 자동 검증
  - 비밀번호 불일치 시 자동 차단

### 교사 독립 입장 시스템 ⭐ NEW
- ✅ **학생 없이 먼저 입장 가능**
  - 교사가 회의실 먼저 생성
  - 학생 접속 대기 모드
  - Peer 연결 유지
  - 여러 학생 순차 접속 가능

### 학생 녹화 승인 시스템 ⭐ NEW
- ✅ **녹화 권한 관리**
  - 학생 녹화 시도 시 교사에게 자동 요청
  - 교사가 승인/거부 결정
  - confirm 다이얼로그로 즉시 응답
  - 채팅에 승인/거부 기록

- ✅ **승인 프로세스**
  1. 학생이 녹화 버튼 클릭
  2. 교사에게 승인 요청 알림
  3. 교사 승인 대기
  4. 승인 시 녹화 시작
  5. 거부 시 녹화 취소

### 모바일 UI 그리드 레이아웃 ⭐ MAJOR UPDATE
- ✅ **바둑판 형태 컨트롤 바**
  - 가로 스크롤 → 4열 그리드로 변경
  - 모든 버튼 한눈에 표시
  - 터치하기 쉬운 큰 버튼
  - 균등한 버튼 크기
  - 스크롤 불필요

- ✅ **모바일 최적화**
  - `display: grid` 레이아웃
  - `grid-template-columns: repeat(4, 1fr)`
  - 버튼 간격 6px
  - 버튼 높이 자동 조절

### 비디오 화면 캡쳐 기능 ⭐ NEW
- ✅ **📸 캡쳐 버튼 추가**
  - 상대방 화면 캡쳐
  - 내 화면 캡쳐
  - PNG 형식으로 저장
  - 자동 파일명 생성

- ✅ **캡쳐 기능**
  - Canvas API 사용
  - 비디오 현재 프레임 캡쳐
  - 원본 해상도 유지
  - 파일명: `ezlive_capture_타입_날짜_시간.png`
  - 채팅에 캡쳐 알림

### 포인터 기능 (이미 구현됨)
- ✅ **붉은 점 포인터**
  - 화면공유 판서 도구에서 사용 가능
  - 마우스 이동 시 붉은 점 표시
  - 그리기 없이 강조만 가능
  - 발표 중 특정 부분 지적

## 🎉 버전 4.2.0 변경사항 ⭐ UX & BUG FIX

### 모바일 UI 완전 개선
- ✅ **컨트롤 바 완전 반응형**
  - 기본 상태에서도 flex-wrap: nowrap 설정
  - 모든 버튼에 flex-shrink: 0 적용
  - overflow-x: auto로 가로 스크롤 활성화
  - 모바일/데스크톱 모두에서 모든 버튼 접근 가능
  - 비디오, 마이크 버튼 항상 표시

### 녹화 폴더 기능 강화
- ✅ **스마트 폴더 열기**
  - Chrome: chrome.downloads API 시도
  - 다른 브라우저: 상세한 안내 메시지
  - Mac: Finder 단축키 안내 (Cmd + Option + L)
  - Windows: shell:downloads 명령어 안내
  - 파일명 형식 안내 포함

### 판서도구 저장 기능 추가 ⭐ NEW
- ✅ **PNG 저장**
  - 화이트보드 내용을 PNG 이미지로 저장
  - canvas.toBlob() API 사용
  - 파일명: ezlive_whiteboard_날짜시간.png
  - 원클릭 다운로드

- ✅ **PDF 저장**
  - 화이트보드 내용을 PDF 문서로 저장
  - jsPDF 라이브러리 동적 로드
  - 캔버스 크기에 맞는 PDF 생성
  - 파일명: ezlive_whiteboard_날짜시간.pdf
  - 실패 시 PNG 저장 안내

### 판서도구 카메라 복원 오류 수정 ⭐ CRITICAL FIX
- ✅ **originalStream 보존**
  - closeWhiteboard()에서 originalStream = null 제거
  - 카메라 스트림을 계속 유지
  - 다음 번 화이트보드 사용 시에도 정상 복원
  
- ✅ **중복 저장 방지**
  - openWhiteboard()에서 originalStream 조건부 저장
  - 이미 저장되어 있으면 재저장하지 않음
  - 카메라 스트림 손실 방지

- ✅ **화면공유 충돌 방지**
  - 화면공유 중 화이트보드 열기 시도 시 경고
  - 화면공유 판서 도구 사용 안내
  - 두 기능 명확히 분리

## 🎉 버전 4.1.0 변경사항 ⭐ CRITICAL FIX

### 강의 코드 지속성 문제 해결 (교사 측)
- ✅ **교사 Peer 유지**
  - 학생이 통화 종료 시 교사의 Peer는 파괴되지 않음
  - 교사는 Step 2로 돌아가 다음 학생 대기
  - 같은 강의 코드로 새 학생 계속 접속 가능
  - 강의 코드 일관성 보장

- ✅ **cleanupCall() vs cleanup()**
  - 교사: cleanupCall() 호출 → Peer 보존, 통화만 정리
  - 학생: cleanup() 호출 → 전체 초기화, 페이지 리로드
  - 통화 종료, 연결 종료, 채팅 히스토리 정리
  - 비디오 스트림 정리
  - Peer 인스턴스는 교사만 유지

### 화면공유 중 판서 도구 개선
- ✅ **채팅 헤더에 판서 버튼 추가**
  - 화면공유 시작 시 채팅 헤더에 ✏️ 버튼 자동 표시
  - 채팅창 상단에서 바로 판서 도구 접근 가능
  - 화면공유 종료 시 자동 숨김
  - 컨트롤 바와 채팅 헤더 버튼 병행 사용 가능

- ✅ **판서 도구 완전한 토글**
  - 판서 도구 끄기 시:
    - 판서 도구 창 자동 닫힘
    - 그리기 캔버스 제거
    - 모든 이벤트 리스너 해제
    - 상태 플래그 리셋
  - 판서 도구 켜기 시:
    - 새 캔버스 생성
    - 새 도구 창 열림
    - 활성 상태 표시

- ✅ **버튼 상태 동기화**
  - 컨트롤 바 판서 버튼과 채팅 헤더 판서 버튼
  - 둘 중 하나를 클릭하면 양쪽 모두 상태 동기화
  - active 클래스 자동 추가/제거
  - 시각적 피드백 일관성

### 모바일 UI 문제 확인
- ✅ **모바일 컨트롤 바**
  - CSS 확인: 이미 flex, nowrap, overflow-x: auto 설정됨
  - 가로 스크롤 정상 작동
  - 추가 수정 불필요

## 🎉 버전 4.0.0 변경사항 ⭐ MAJOR UPDATE

### 화이트보드 기능 추가
- ✅ **독립 판서도구 버튼**
  - 화면공유 옆에 별도 판서도구 버튼 추가
  - 언제든지 켜고 끌 수 있는 토글 기능
  - 화면공유와 독립적으로 작동

- ✅ **새창 화이트보드**
  - 1200x800 크기의 화이트보드 새창
  - 실시간 캔버스 스트림 공유
  - 상대방에게 그대로 전송
  - 펜, 지우개, 포인터, 전체삭제 도구
  - 색상 및 굵기 조절 가능

### 화면공유 중 판서 기능 개선
- ✅ **화면공유 전용 판서**
  - 화면공유 시작 시 판서 버튼 자동 표시
  - 판서 버튼으로 화면 위에 직접 그리기
  - 화면공유와 판서를 독립적으로 제어
  - 판서만 끄고 화면공유는 유지 가능

- ✅ **지우개 버그 수정**
  - destination-out 모드 사용
  - 판서만 지우고 배경 화면은 보존
  - 투명 효과로 자연스러운 지우기

### 모바일 지원 대폭 강화
- ✅ **모바일 화면공유**
  - iOS Safari, Android Chrome 지원
  - 모바일 기기 화면을 그대로 공유
  - 터치 친화적 인터페이스

- ✅ **모바일 녹화**
  - 모바일 기기에서 화면 녹화 가능
  - 시스템 오디오 캡처 시도
  - MediaRecorder API 완벽 지원

## 🎉 버전 3.0.0 변경사항 ⭐ MAJOR UPDATE

### 강의 코드 시스템 개선
- ✅ **고정 강의 코드** PeerID 고정값 사용
  - 교사가 원하는 강의 코드 직접 입력
  - 빈칸으로 두면 랜덤 8자리 자동 생성
  - 같은 코드로 항상 접속 가능
  - 중복 코드 자동 감지 및 경고 (unavailable-id 에러)

- ✅ **localStorage 자동 저장**
  - 교사 이름, 비밀번호, 강의 코드 자동 저장
  - 다음 접속 시 자동으로 불러오기
  - 편리한 재사용

### 판서 기능 대폭 개선
- ✅ **수동 실행**
  - 화면공유 시 자동 표시 X
  - ✏️ 판서 버튼 클릭으로 수동 실행
  - 필요할 때만 사용

- ✅ **새창 모드**
  - 판서 도구를 별도 팝업 창으로 띄우기
  - 항상 위에 표시되어 가리지 않음
  - 전체화면/최대화에서도 사용 가능
  - 자유로운 위치 조정

- ✅ **포인터 기능**
  - 🔴 붉은 점 포인터 추가
  - 마우스/터치 이동 시만 표시
  - 그리지 않고 강조만 할 때 유용
  - 발표 중 특정 부분 지적

### 모바일 최적화 유지
- ✅ toolbar는 이미 flex, nowrap, overflow-x 설정 완료
- ✅ 모바일 반응형 완벽 지원

## 🎉 버전 2.6.0 변경사항 ⭐ MOBILE UPDATE

### 모바일 반응형 완성
- ✅ **모바일 컨트롤 바** 가로 스크롤 최적화
  - 버튼 가로 배치, 스크롤 가능
  - 아이콘 + 레이블 명확한 표시
  - 터치 친화적 크기 (60px → 50px on 480px)
  - 스크롤바 숨김 처리

- ✅ **모바일 비디오 레이아웃** 세로 스택
  - 상대방 화면 위, 내 화면 아래
  - 16:9 aspect-ratio 자동 조절
  - max-height 제한 (40vh / 30vh)
  - 전체화면 모드 100vw x 100vh

- ✅ **모바일 채팅창** 슬라이드업
  - 하단 고정, 탭하여 열기/닫기
  - 60px 미리보기 표시
  - "👆 탭하여 열기" 힌트 표시
  - 전체화면 시 하단 40vh 고정

- ✅ **비디오 자동재생 처리**
  - playVideoSafely() 함수 추가
  - 모바일 자동재생 정책 대응
  - 재생 실패 시 수동 재생 버튼 표시
  - NotAllowedError 핸들링

- ✅ **모바일 전체화면 최적화**
  - window.innerWidth 감지
  - 모바일: 채팅창 하단 배치
  - 데스크톱: 채팅창 우측 배치
  - ESC 키로 나가기

- ✅ **판서 도구 모바일 위치**
  - 하단 우측 고정 (bottom: 80px)
  - 터치 이벤트 완벽 지원
  - 모바일 화면에 맞춘 크기

- ✅ **README 모바일 가이드 추가**
  - 모바일 접속 방법
  - 컨트롤 바 사용법
  - 채팅창 슬라이드업
  - 터치 조작 가이드
  - 문제 해결 팁

### 버전 2.5.1 기능
- ✅ **인앱 브라우저 감지 및 리다이렉트**
  - 카카오톡 인앱 브라우저 자동 감지
  - 네이버, 페이스북, 인스타그램, 라인 앱 감지
  - iOS: Safari 열기 안내 페이지 자동 표시
  - Android: Chrome 자동 리다이렉트 (intent:// 스킴)
  - 카메라/마이크 권한 문제 사전 방지

### 버전 2.5.0 기능
- ✅ **초대링크 시스템** ⭐ NEW
  - URL query parameter 기반 초대링크 생성
  - 교사가 강의 생성 시 자동 생성
  - 초대링크 원클릭 복사
  - 학생이 링크 클릭 시 간소화된 UI
  - 강의 코드 입력 생략
  - 이름만 입력하고 바로 참여
  - 형식: `https://your-site.com/?invitation-code=PEER_ID`
  - **인앱 브라우저 자동 감지** ⭐ NEW
    - 카카오톡, 네이버, 페이스북, 인스타그램, 라인 감지
    - iOS: Safari 열기 안내 페이지 표시
    - Android: Chrome 자동 리다이렉트 또는 안내
    - 카메라/마이크 권한 문제 해결

### 이전 버전 기능 (v2.4.0)
- ✅ **판서 기능** ⭐ NEW
  - 화면공유 중 실시간 그리기 기능
  - 색상 선택기 (컬러 픽커)
  - 굵기 조절 (1~20px)
  - 펜/지우개 모드 전환
  - 전체 삭제 버튼
  - 마우스 및 터치 지원

- ✅ **화면공유 알림 시스템** ⭐ NEW
  - 화면공유 시작 시 채팅에 시스템 메시지
  - 화면공유 종료 시 채팅에 시스템 메시지
  - 상대방에게도 실시간 알림 전송

- ✅ **종료 시 채팅 저장 확인** ⭐ NEW
  - 통화 종료 버튼 클릭 시 모달 표시
  - 💾 저장하고 종료
  - 종료만
  - 취소

- ✅ **녹화 기능** ⭐ NEW
  - 브라우저 내장 녹화 기능 (MediaRecorder API)
  - 화면 + 음성 동시 녹화
  - WebM 형식 자동 저장
  - 녹화 시작/중지 버튼
  - 실시간 녹화 상태 표시 (빨간색 깜빡임)
  - 자동 파일명 생성 (날짜_시간)
  - 다운로드 폴더 안내
  - 채팅에 녹화 시작/중지 알림

### v2.3.0 기능
- ✅ **학생 화면공유 승인 시스템**
  - 학생이 화면공유 버튼 클릭 시 교사에게 자동 요청
  - 교사에게 승인/거부 모달 표시
  - 교사 승인 후 학생이 화면공유 시작
  - 거부 시 학생에게 알림
  - 채팅창에 승인/거부 내역 표시
  - 교사는 승인 없이 즐시 화면공유 가능

### 이전 버전 기능 (v2.2.0)
- ✅ **교사/학생 이름 입력 기능**
  - 강의 생성/참여 시 이름 입력 필수
  - 비디오 화면에 실제 이름 표시
  - 채팅 메시지에 보낸 사람 이름 표시
- ✅ **채팅창 토글 버튼**
  - 채팅창을 닫았다 다시 열 수 있음
  - 컨트롤 바에 채팅창 버튼 추가
- ✅ **다시보기 버튼**
  - LMS 버튼 옆에 위치
  - https://jlive.co.kr/ 링크 연결

### 기존 버그 수정 (v2.1.1)
- ✅ 파일 전송 기능 오류 수정
- ✅ 채팅 전체화면 모드 오류 수정
- ✅ 채팅 새창 열기 기능 오류 수정
- ✅ PIP 모드 오류 수정
- ✅ 비디오 최대화/최소화 오류 수정
- ✅ JavaScript null reference 오류 수정
- ✅ 모든 버튼에 null 체크 추가 (안정성 향상)
